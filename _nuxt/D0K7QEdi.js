import{_ as D}from"./CyYys1tf.js";import{C as g,_ as L,V as y,B as R,a as M,S as W,P as X}from"./Cv3oP066.js";import{G as $}from"./DNkUmkFf.js";import{m as H,n as q,r as F,c as J,o as K,b as P,a as Q,w as Z,d as tt,F as et,p as ot,_ as nt}from"./B9ZuqNB7.js";const rt=`
  varying vec3 vColor;
  void main() {
    gl_FragColor = vec4(vColor, 1.0);
  }
`,at=H({__name:"explosion-particles",setup(st){const d={geometries:new Set,materials:new Set,gui:null},a=q({attractionStrength:.5,returnSpeed:.02,particleSize:.03,particleCount:5e3,noiseStrength:.1,useYellowOrange:!1}),h=F(new g(657946)),v=F(),k=[];let _=new y(0,0,0),C=!1,B=0;const E=()=>{const c=(Math.random()-.5)*2,o=(Math.random()-.5)*2,i=(Math.random()-.5)*2;return new y(c,o,i).multiplyScalar(a.noiseStrength)},T=`
  attribute vec3 color;
  varying vec3 vColor;
  void main() {
    vColor = color;
    gl_PointSize = ${a.particleSize.toFixed(2)} * 100.0;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,U=()=>{const c=new R,o=new Float32Array(a.particleCount*3),i=new Float32Array(a.particleCount*3),s=new Float32Array(a.particleCount*3),n=new g(657946);for(let t=0;t<a.particleCount;t++){const w=(Math.random()-.5)*20,f=(Math.random()-.5)*20,u=(Math.random()-.5)*20;o[t*3]=w,o[t*3+1]=f,o[t*3+2]=u,i[t*3]=0,i[t*3+1]=0,i[t*3+2]=0,s[t*3]=n.r,s[t*3+1]=n.g,s[t*3+2]=n.b,k.push(new y(w,f,u))}c.setAttribute("position",new M(o,3)),c.setAttribute("velocity",new M(i,3)),c.setAttribute("color",new M(s,3)),d.geometries.add(c);const r=new W({vertexShader:T,fragmentShader:rt,transparent:!0});return d.materials.add(r),new X(c,r)},V=c=>{const o=new $;d.gui=o,o.add(a,"attractionStrength",.05,1,.1).name("Сила притяжения"),o.add(a,"returnSpeed",.01,.1,.01).name("Скорость возврата"),o.add(a,"noiseStrength",0,.5,.01).name("Сила шума"),o.add(a,"useYellowOrange").name("Отобразить частицы")},N=({scene:c,renderer:o,camera:i})=>{c.background=new g("#0a0a1a");const s=U();c.add(s),V(),window.addEventListener("click",n=>{var m;const r=(m=d.gui)==null?void 0:m.domElement;if(r&&(n.target===r||r.contains(n.target)))return;const t=n.clientX/window.innerWidth*2-1,w=-(n.clientY/window.innerHeight)*2+1,u=new y(t,w,.5).unproject(i).sub(i.position).normalize(),b=-i.position.z/u.z;_=i.position.clone().add(u.multiplyScalar(b)),C=!0,B=performance.now(),setTimeout(()=>C=!1,1e3)}),v.value&&v.value.onTick(()=>{const n=s.geometry.attributes.position.array,r=s.geometry.attributes.velocity.array,t=s.geometry.attributes.color.array,w=new g(657946),f=new g(16761095),u=new g(14745599),b=a.useYellowOrange?f:w;h.value.lerp(b,.05);for(let m=0;m<a.particleCount;m++){const e=m*3,p=new y(n[e],n[e+1],n[e+2]),l=new y(r[e],r[e+1],r[e+2]),Y=k[m],G=E();if(l.add(G),C){const x=_.clone().sub(p).normalize();l.add(x.multiplyScalar(a.attractionStrength));const A=p.distanceTo(_),O=Math.min(1,1-A/20),I=(performance.now()-B)/1e3,j=Math.min(1,I*2),z=h.value.clone().lerp(u,j*O);t[e]=z.r,t[e+1]=z.g,t[e+2]=z.b}else{const x=Y.clone().sub(p).normalize();l.add(x.multiplyScalar(a.returnSpeed));const S=new g(t[e],t[e+1],t[e+2]).lerp(h.value,.05);t[e]=S.r,t[e+1]=S.g,t[e+2]=S.b}l.clampLength(0,.5),p.add(l),n[e]=p.x,n[e+1]=p.y,n[e+2]=p.z,r[e]=l.x,r[e+1]=l.y,r[e+2]=l.z}s.geometry.attributes.position.needsUpdate=!0,s.geometry.attributes.velocity.needsUpdate=!0,s.geometry.attributes.color.needsUpdate=!0}),ot(()=>{var n;d.geometries.forEach(r=>r.dispose()),d.materials.forEach(r=>r.dispose()),(n=d.gui)==null||n.destroy()})};return(c,o)=>{const i=D,s=L;return K(),J(et,null,[P(i,{class:"go-back",to:"/"},{default:Z(()=>o[0]||(o[0]=[tt("⭠ на главную")])),_:1}),o[1]||(o[1]=Q("p",{class:"helper"},"нажми в любую область",-1)),P(s,{class:"explosion-particles",ref_key:"threeContainer",ref:v,"camera-position":[0,0,30],"custom-animation":"",onSceneReady:N},null,512)],64)}}}),ut=nt(at,[["__scopeId","data-v-702c1e49"]]);export{ut as default};
