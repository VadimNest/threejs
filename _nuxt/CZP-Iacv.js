import{_ as q}from"./CyYys1tf.js";import{D as J,H as C,F as U,b as k,L as K,c as P,_ as Q,E as Z,d as ee,G as ae,e as v,f as oe,g as te,M as $,h as Y,i as re,A as ne,T as se,j as ie}from"./Cv3oP066.js";import{G as ce}from"./DNkUmkFf.js";import{m as de,n as le,r as he,c as pe,b as O,w as me,F as ge,o as _e,d as ue,p as we}from"./B9ZuqNB7.js";class Ee extends J{constructor(g){super(g),this.type=C}parse(g){const h=function(e,n){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(n||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(n||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(n||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(n||""))}},o=`
`,w=function(e,n,i){n=n||1024;let p=e.pos,l=-1,a=0,m="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(p,p+128)));for(;0>(l=s.indexOf(o))&&a<n&&p<e.byteLength;)m+=s,a+=s.length,p+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(p,p+128)));return-1<l?(e.pos+=a+l+1,m+s.slice(0,l)):!1},_=function(e){const n=/^#\?(\S+)/,i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,d=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,p=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let m,s;for((e.pos>=e.byteLength||!(m=w(e)))&&h(1,"no header found"),(s=m.match(n))||h(3,"bad initial token"),a.valid|=1,a.programtype=s[1],a.string+=m+`
`;m=w(e),m!==!1;){if(a.string+=m+`
`,m.charAt(0)==="#"){a.comments+=m+`
`;continue}if((s=m.match(i))&&(a.gamma=parseFloat(s[1])),(s=m.match(d))&&(a.exposure=parseFloat(s[1])),(s=m.match(p))&&(a.valid|=2,a.format=s[1]),(s=m.match(l))&&(a.valid|=4,a.height=parseInt(s[1],10),a.width=parseInt(s[2],10)),a.valid&2&&a.valid&4)break}return a.valid&2||h(3,"missing format specifier"),a.valid&4||h(3,"missing image size specifier"),a},u=function(e,n,i){const d=n;if(d<8||d>32767||e[0]!==2||e[1]!==2||e[2]&128)return new Uint8Array(e);d!==(e[2]<<8|e[3])&&h(3,"wrong scanline width");const p=new Uint8Array(4*n*i);p.length||h(4,"unable to allocate buffer space");let l=0,a=0;const m=4*d,s=new Uint8Array(4),B=new Uint8Array(m);let j=i;for(;j>0&&a<e.byteLength;){a+4>e.byteLength&&h(1),s[0]=e[a++],s[1]=e[a++],s[2]=e[a++],s[3]=e[a++],(s[0]!=2||s[1]!=2||(s[2]<<8|s[3])!=d)&&h(3,"bad rgbe scanline format");let F=0,f;for(;F<m&&a<e.byteLength;){f=e[a++];const b=f>128;if(b&&(f-=128),(f===0||F+f>m)&&h(3,"bad scanline data"),b){const R=e[a++];for(let N=0;N<f;N++)B[F++]=R}else B.set(e.subarray(a,a+f),F),F+=f,a+=f}const X=d;for(let b=0;b<X;b++){let R=0;p[l]=B[b+R],R+=d,p[l+1]=B[b+R],R+=d,p[l+2]=B[b+R],R+=d,p[l+3]=B[b+R],l+=4}j--}return p},E=function(e,n,i,d){const p=e[n+3],l=Math.pow(2,p-128)/255;i[d+0]=e[n+0]*l,i[d+1]=e[n+1]*l,i[d+2]=e[n+2]*l,i[d+3]=1},S=function(e,n,i,d){const p=e[n+3],l=Math.pow(2,p-128)/255;i[d+0]=k.toHalfFloat(Math.min(e[n+0]*l,65504)),i[d+1]=k.toHalfFloat(Math.min(e[n+1]*l,65504)),i[d+2]=k.toHalfFloat(Math.min(e[n+2]*l,65504)),i[d+3]=k.toHalfFloat(1)},t=new Uint8Array(g);t.pos=0;const y=_(t),G=y.width,V=y.height,A=u(t.subarray(t.pos),G,V);let D,H,L;switch(this.type){case U:L=A.length/4;const e=new Float32Array(L*4);for(let i=0;i<L;i++)E(A,i*4,e,i*4);D=e,H=U;break;case C:L=A.length/4;const n=new Uint16Array(L*4);for(let i=0;i<L;i++)S(A,i*4,n,i*4);D=n,H=C;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:G,height:V,data:D,header:y.string,gamma:y.gamma,exposure:y.exposure,type:H}}setDataType(g){return this.type=g,this}load(g,r,M,x){function I(h,T){switch(h.type){case U:case C:h.colorSpace=K,h.minFilter=P,h.magFilter=P,h.generateMipmaps=!1,h.flipY=!0;break}r&&r(h,T)}return super.load(g,I,M,x)}}const Se=de({__name:"figures",setup(W){const g={geometries:new Set,materials:new Set,textures:new Set,gui:null},r=le({cube:{rotationSpeed:.5,color:"#00ff00",scale:1,height:2,position:{x:-2,y:1,z:-1}},sphere:{rotationSpeed:.3,color:"#ff0000",scale:1,height:2,position:{x:0,y:1,z:2}},door:{width:1,height:2,position:{x:3,y:1,z:1}}}),M=he(),x=(c,o,w=!1,_=!1)=>{const u=new $({color:o,metalness:.45,roughness:.65});g.geometries.add(c),g.materials.add(u);const E=new Y(c,u);return E.castShadow=_,E.receiveShadow=w,E},I=c=>{const o=new re(16777215,1);o.position.set(5,5,2),o.castShadow=!0,o.shadow.mapSize.width=1024,o.shadow.mapSize.height=1024,o.shadow.camera.near=.1,o.shadow.camera.far=20,o.shadow.camera.left=-10,o.shadow.camera.right=10,o.shadow.camera.top=10,o.shadow.camera.bottom=-10;const w=new ne(16777215,.5);c.add(o,w)},h=(c,o,w)=>{const _=new ce;g.gui=_;const u=_.addFolder("Куб");u.add(r.cube,"rotationSpeed",0,5,.1).name("Скорость вращения"),u.addColor(r.cube,"color").onChange(t=>{c.material.color.set(t)}),u.add(r.cube,"scale",.1,3,.1).name("Размер").onChange(t=>{c.scale.set(t,t,t)}),u.add(r.cube,"height",0,5,.1).name("Высота").onChange(t=>{c.position.y=t});const E=_.addFolder("Сфера");E.add(r.sphere,"rotationSpeed",0,5,.1).name("Скорость вращения"),E.addColor(r.sphere,"color").onChange(t=>{o.material.color.set(t)}),E.add(r.sphere,"scale",.1,3,.1).name("Размер").onChange(t=>{o.scale.set(t,t,t)}),E.add(r.sphere,"height",0,5,.1).name("Высота").onChange(t=>{o.position.y=t});const S=_.addFolder("Дверь");S.add(r.door,"width",.5,2,.1).name("Ширина").onChange(t=>{w.scale.x=t}),S.add(r.door,"height",1,3,.1).name("Высота").onChange(t=>{w.scale.y=t,w.position.y=t*2/2})},T=()=>{const c=new se,o=c.load("textures/figures/color.jpg");g.textures.add(o);const w=new v(2,2,100,100),_=new $({map:o,aoMap:c.load("./textures/figures/ambientOcclusion.jpg"),displacementMap:c.load("./textures/figures/height.jpg"),normalMap:c.load("./textures/figures/normal.jpg"),alphaMap:c.load("./textures/figures/alpha.jpg"),metalnessMap:c.load("./textures/figures/metalness.jpg"),roughnessMap:c.load("./textures/figures/roughness.jpg"),displacementScale:.1,aoMapIntensity:1,transparent:!0,side:ie});_.normalScale.set(2.5,2.5),g.geometries.add(w),g.materials.add(_);const u=new Y(w,_);return u.castShadow=!0,u.position.set(r.door.position.x,r.door.position.y,r.door.position.z),u},z=({scene:c,renderer:o})=>{new Ee().load("textures/figures/background-2.hdr",y=>{y.mapping=Z,c.background=y,c.environment=y}),o.shadowMap.enabled=!0,o.shadowMap.type=ee;const _=new ae,u=x(new v(10,10),"#fff",!0,!1);u.rotation.x=-Math.PI/2,u.position.y=0;const E=x(new oe(1,1,1),r.cube.color,!1,!0);E.position.set(r.cube.position.x,r.cube.position.y,r.cube.position.z);const S=x(new te(.6,32,32),r.sphere.color,!1,!0);S.position.set(r.sphere.position.x,r.sphere.position.y,r.sphere.position.z),_.add(E,S),I(c);const t=T();c.add(u,_,t),h(E,S,t),M.value&&M.value.onTick(y=>{E.rotation.x=y*r.cube.rotationSpeed,E.rotation.y=y*(r.cube.rotationSpeed*.4)}),we(()=>{var y;g.geometries.forEach(G=>G.dispose()),g.materials.forEach(G=>G.dispose()),(y=g.gui)==null||y.destroy(),g.textures.forEach(G=>G.dispose())})};return(c,o)=>{const w=q,_=Q;return _e(),pe(ge,null,[O(w,{class:"go-back",to:"/"},{default:me(()=>o[0]||(o[0]=[ue("⭠ на главную")])),_:1}),O(_,{ref_key:"threeContainer",ref:M,"camera-position":[-10,5,10],"custom-animation":"",onSceneReady:z},null,512)],64)}}});export{Se as default};
